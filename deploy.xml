<?xml version="1.0"?>
<project name="Build" default="CompleteDeployment" basedir=".">
	<!--
	OVERVIEW
	This script deploys a locally built code-base to a remote FTP site.

	REQUIREMENTS
	This script requires that ANT FTP task be installed and configured correctly.
	For more info visit: http://ant.apache.org/manual/OptionalTasks/ftp.html

	DEVELOPED BY
	Bassil Karam (bassil.karam@t-mobile.com)
	June 19, 2007
	-->

	<!-- load properties -->
	<property file="build.properties" />
	<property file="deploy.properties" />

	<!-- Choose Mode: ask user whether they want to deploy to (D)evelopment, (S)taging or (P)roduction? -->
	<target name="ChooseMode">
		<input 
	  		message="Do you want to deploy to (D)evelopment, (S)taging or (P)roduction?" 
			validargs="D,S,P"
			addproperty="Mode" />
		
		<condition property="do.InitDevelopment">
			<equals arg1="D" arg2="${Mode}" />
		</condition>		
		<condition property="do.InitStaging">
			<equals arg1="S" arg2="${Mode}" />
		</condition>
		<condition property="do.InitProduction">
			<equals arg1="P" arg2="${Mode}" />
		</condition>
	</target>

	<!-- setup final deployment properties -->
	<target name="InitDevelopment" depends="ChooseMode" if="do.InitDevelopment">
		<property name="ftp.final.server" value="${ftp.development.server}" />
		<property name="ftp.final.remotepath" value="${ftp.development.remotepath}" />
		<property name="ftp.final.username" value="${ftp.development.username}" />
		<property name="ftp.final.password" value="${ftp.development.password}" />
	</target>
	<target name="InitStaging" depends="ChooseMode" if="do.InitStaging">
		<property name="ftp.final.server" value="${ftp.staging.server}" />
		<property name="ftp.final.remotepath" value="${ftp.staging.remotepath}" />
		<property name="ftp.final.username" value="${ftp.staging.username}" />
		<property name="ftp.final.password" value="${ftp.staging.password}" />
	</target>
	<target name="InitProduction" depends="ChooseMode" if="do.InitProduction">
		<property name="ftp.final.server" value="${ftp.production.server}" />
		<property name="ftp.final.remotepath" value="${ftp.production.remotepath}" />
		<property name="ftp.final.username" value="${ftp.production.username}" />
		<property name="ftp.final.password" value="${ftp.production.password}" />
	</target>	

	<!-- Copy files to remote folder -->
	<target name="CopyFilesToRemote" depends="InitDevelopment,InitStaging,InitProduction">
		<ftp
		action="send"
		server="${ftp.final.server}"
		remotedir="${ftp.final.remotepath}"
		userid="${ftp.final.username}"
		password="${ftp.final.password}"
		verbose="true">
			<fileset dir="${path.build}" />
		</ftp>
	</target>
	
	<!-- Complete Deployment -->
	<target name="CompleteDeployment" depends="CopyFilesToRemote">		
	</target>
</project>